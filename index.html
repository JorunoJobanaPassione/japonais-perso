<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Japonais">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="Apprends le Japonais - Hiragana, Katakana, Kanji N5">

    <title>Japonais - Apprentissage Personnel</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-167.png">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- App Container -->
    <div id="app">

        <!-- =========================================
             HOME SCREEN (HomeScreen.js EXACT)
             ========================================= -->
        <section id="home-screen" class="screen active">
            <!-- Header -->
            <div class="home-header">
                <div class="greeting">Bonjour !</div>
                <div class="home-subtitle">Pret a apprendre le japonais ?</div>
            </div>

            <!-- Stats Card -->
            <div class="stats-card">
                <div class="card-title">Ta Progression</div>
                <div class="stats-row">
                    <div class="stat-item">
                        <span class="stat-value" id="home-total-cards">0</span>
                        <span class="stat-label">Cartes SRS</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="home-streak">0</span>
                        <span class="stat-label">Jours</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="home-xp">0</span>
                        <span class="stat-label">Points XP</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Card -->
            <div class="stats-card">
                <div class="card-title">Actions Rapides</div>

                <button class="action-button" id="btn-lessons">
                    <span class="action-emoji">üìö</span>
                    <div class="action-text-container">
                        <span class="action-title">Commencer une lecon</span>
                        <span class="action-subtitle">47 lecons disponibles</span>
                    </div>
                    <span class="action-arrow">‚Ä∫</span>
                </button>

                <button class="action-button" id="btn-srs">
                    <span class="action-emoji">üîÑ</span>
                    <div class="action-text-container">
                        <span class="action-title">Revisions SRS</span>
                        <span class="action-subtitle" id="srs-subtitle">Aucune revision pour le moment</span>
                    </div>
                    <div id="srs-badge" class="badge-error hidden">
                        <span class="badge-text" id="srs-badge-count">0</span>
                    </div>
                    <span class="action-arrow">‚Ä∫</span>
                </button>

                <button class="action-button" id="btn-stats">
                    <span class="action-emoji">üìä</span>
                    <div class="action-text-container">
                        <span class="action-title">Voir tes stats</span>
                        <span class="action-subtitle">Progression et performances</span>
                    </div>
                    <span class="action-arrow">‚Ä∫</span>
                </button>
            </div>

            <!-- Info Card -->
            <div class="stats-card">
                <div class="info-text">
                    Version Personnelle - Acces Illimite<br>
                    47 lecons - 102 kanji - 400+ exercices
                </div>
            </div>
        </section>

        <!-- =========================================
             LESSONS SCREEN (LessonsScreen.js EXACT)
             ========================================= -->
        <section id="lessons-screen" class="screen">
            <!-- Header -->
            <div class="lessons-header">
                <div class="lessons-title">üìö Lecons</div>
                <div class="lessons-subtitle">Choisis ce que tu veux apprendre</div>
            </div>

            <!-- Categories Horizontal Scroll -->
            <div class="categories-container">
                <div class="categories-content" id="categories-tabs">
                    <button class="category-card active" data-category="hiragana">
                        <span class="category-emoji">„ÅÇ</span>
                        <span class="category-name">Hiragana</span>
                        <span class="category-count">10 lecons</span>
                    </button>
                    <button class="category-card" data-category="katakana">
                        <span class="category-emoji">„Ç¢</span>
                        <span class="category-name">Katakana</span>
                        <span class="category-count">11 lecons</span>
                    </button>
                    <button class="category-card" data-category="vocabulary">
                        <span class="category-emoji">Êï∞</span>
                        <span class="category-name">Vocabulaire</span>
                        <span class="category-count">6 lecons</span>
                    </button>
                    <button class="category-card" data-category="kanji">
                        <span class="category-emoji">Êº¢</span>
                        <span class="category-name">Kanji</span>
                        <span class="category-count">20 lecons</span>
                    </button>
                </div>
            </div>

            <!-- Lessons List -->
            <div id="lessons-list" class="lessons-list"></div>
        </section>

        <!-- =========================================
             LESSON DETAIL SCREEN
             ========================================= -->
        <section id="lesson-detail-screen" class="screen">
            <button class="back-btn" id="back-from-detail">
                <span>‚Äπ</span>
                <span>Retour</span>
            </button>

            <div class="lesson-detail-header">
                <div class="lesson-detail-title" id="lesson-title">Titre</div>
                <div class="lesson-detail-desc" id="lesson-description">Description</div>
                <div class="lesson-meta">
                    <span class="meta-item" id="lesson-chars-count">0 caracteres</span>
                    <span class="meta-item" id="lesson-difficulty">Debutant</span>
                </div>
            </div>

            <div class="characters-section-title">Caracteres de la lecon</div>
            <div id="characters-grid" class="characters-grid"></div>

            <button id="start-exercises-btn" class="button">
                <span class="button-text">Commencer les exercices</span>
            </button>
        </section>

        <!-- =========================================
             EXERCISE SCREEN (ExerciseScreen.js EXACT)
             ========================================= -->
        <section id="exercise-screen" class="screen">
            <!-- Exercise Header -->
            <div class="exercise-header">
                <button class="close-button" id="close-exercise">‚úï</button>
                <div class="exercise-progress-container">
                    <div id="exercise-progress-bar" class="exercise-progress-bar" style="width: 0%"></div>
                </div>
                <div class="lives-container">
                    <span class="lives-text" id="lives-display">‚àû</span>
                </div>
            </div>

            <!-- Streak Banner (hidden by default) -->
            <div id="streak-banner" class="streak-banner hidden">
                <span class="streak-text" id="streak-text">üî• Serie de 0 !</span>
            </div>

            <!-- Exercise Content -->
            <div class="exercise-content">
                <div class="exercise-question" id="exercise-question">Question</div>
                <div class="exercise-character" id="exercise-character"></div>
                <div id="exercise-options" class="exercise-options"></div>
                <div id="transcription-container" class="transcription-container hidden">
                    <input type="text" id="transcription-input" class="transcription-input" placeholder="Tape ta reponse..." autocomplete="off" autocapitalize="off">
                    <button id="submit-answer-btn" class="button" style="margin-top: 16px;">
                        <span class="button-text">Valider</span>
                    </button>
                </div>
            </div>

            <!-- Feedback Overlay -->
            <div id="feedback-overlay" class="feedback-overlay hidden">
                <span class="feedback-text" id="feedback-text"></span>
            </div>
        </section>

        <!-- =========================================
             RESULTS SCREEN
             ========================================= -->
        <section id="results-screen" class="screen">
            <div class="results-container">
                <div class="results-title" id="results-title">üéâ Lecon Terminee !</div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-card-value" id="result-accuracy">0%</span>
                        <span class="stat-card-label">Precision</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value" id="result-score">0/0</span>
                        <span class="stat-card-label">Correct</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-card-value xp" id="result-xp">+0</span>
                        <span class="stat-card-label">XP</span>
                    </div>
                </div>

                <button id="results-done-btn" class="button">
                    <span class="button-text">Termine</span>
                </button>
            </div>
        </section>

        <!-- =========================================
             SRS SCREEN
             ========================================= -->
        <section id="srs-screen" class="screen">
            <button class="back-btn" id="back-from-srs">
                <span>‚Äπ</span>
                <span>Retour</span>
            </button>

            <div class="srs-header-card">
                <div class="title" style="margin-bottom: 8px;">Revisions SRS</div>
                <div class="text-secondary">Cartes a reviser aujourd'hui</div>
                <div class="srs-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="srs-new">0</span>
                        <span class="stat-label">Nouvelles</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="srs-learning">0</span>
                        <span class="stat-label">En cours</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="srs-review">0</span>
                        <span class="stat-label">Revision</span>
                    </div>
                </div>
            </div>

            <!-- SRS Card -->
            <div id="srs-card-container" class="srs-card-container">
                <div class="srs-card" id="srs-card">
                    <span class="srs-character" id="srs-character"></span>
                    <div id="srs-answer-container" class="hidden">
                        <span class="srs-answer" id="srs-answer"></span>
                        <span class="srs-reading" id="srs-reading"></span>
                    </div>
                </div>
            </div>

            <button id="srs-show-btn" class="button">
                <span class="button-text">Montrer la reponse</span>
            </button>

            <div id="srs-buttons" class="srs-buttons hidden">
                <button class="srs-btn again" data-quality="0">
                    <span class="srs-btn-label">A revoir</span>
                    <span class="srs-btn-time">&lt;1min</span>
                </button>
                <button class="srs-btn hard" data-quality="2">
                    <span class="srs-btn-label">Difficile</span>
                    <span class="srs-btn-time">1j</span>
                </button>
                <button class="srs-btn good" data-quality="3">
                    <span class="srs-btn-label">Bien</span>
                    <span class="srs-btn-time">3j</span>
                </button>
                <button class="srs-btn easy" data-quality="4">
                    <span class="srs-btn-label">Facile</span>
                    <span class="srs-btn-time">7j</span>
                </button>
            </div>

            <!-- SRS Complete -->
            <div id="srs-complete" class="srs-complete hidden">
                <div class="complete-icon">üéâ</div>
                <div class="title">Revisions terminees !</div>
                <div class="text-secondary" style="margin: 16px 0;">Tu as revise <span id="srs-reviewed-count">0</span> cartes</div>
                <button class="button" id="srs-back-home">
                    <span class="button-text">Retour a l'accueil</span>
                </button>
            </div>
        </section>

        <!-- =========================================
             STATS SCREEN
             ========================================= -->
        <section id="stats-screen" class="screen">
            <button class="back-btn" id="back-from-stats">
                <span>‚Äπ</span>
                <span>Retour</span>
            </button>

            <div class="title">üìä Statistiques</div>

            <div class="stats-container">
                <div class="card">
                    <div class="card-title">Progression Generale</div>
                    <div class="stats-grid-2">
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-xp">0</span>
                            <span class="stat-box-label">XP Total</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-streak">0</span>
                            <span class="stat-box-label">Jours d'affilee</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-lessons">0</span>
                            <span class="stat-box-label">Lecons terminees</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-exercises">0</span>
                            <span class="stat-box-label">Exercices faits</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Precision</div>
                    <div class="stats-grid-2">
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-correct">0</span>
                            <span class="stat-box-label">Reponses correctes</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-accuracy">0%</span>
                            <span class="stat-box-label">Taux de reussite</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Cartes SRS</div>
                    <div class="stats-grid-2">
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-srs-total">0</span>
                            <span class="stat-box-label">Total de cartes</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-box-value" id="stats-srs-mastered">0</span>
                            <span class="stat-box-label">Maitrisees</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- =========================================
             CHARACTER MODAL
             ========================================= -->
        <div id="character-modal" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" id="close-modal">√ó</button>
                <div class="modal-character" id="modal-char"></div>
                <div class="modal-romaji" id="modal-romaji"></div>
                <div class="modal-mnemonic" id="modal-mnemonic"></div>
                <button class="audio-btn" id="modal-audio-btn">
                    üîä Ecouter
                </button>
                <!-- Kanji specific info -->
                <div id="kanji-details" class="kanji-details hidden">
                    <div class="reading-section">
                        <span class="reading-label">On'yomi:</span>
                        <span id="modal-onyomi" class="reading-value"></span>
                    </div>
                    <div class="reading-section">
                        <span class="reading-label">Kun'yomi:</span>
                        <span id="modal-kunyomi" class="reading-value"></span>
                    </div>
                    <div class="kanji-examples" id="modal-examples"></div>
                </div>
            </div>
        </div>

        <!-- =========================================
             BOTTOM NAVIGATION
             ========================================= -->
        <nav id="bottom-nav">
            <button class="nav-item active" data-screen="home">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                <span>Accueil</span>
            </button>
            <button class="nav-item" data-screen="lessons">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/>
                </svg>
                <span>Lecons</span>
            </button>
            <button class="nav-item" data-screen="srs">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
                </svg>
                <span>SRS</span>
            </button>
            <button class="nav-item" data-screen="stats">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                </svg>
                <span>Stats</span>
            </button>
        </nav>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <span class="loading-text">Chargement...</span>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Scripts -->
    <script src="data.js"></script>
    <script src="srs.js"></script>
    <script src="exercises.js"></script>
    <script src="app.js"></script>

    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
